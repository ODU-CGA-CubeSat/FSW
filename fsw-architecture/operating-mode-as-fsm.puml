@startuml

state AntennaDeployment
      AntennaDeployment : Deploy antenna
      AntennaDeployment : Verify deployment
state SafeHold
      SafeHold : Transmit SeaLion Beacon
state QueryReceiver
      QueryReceiver : Check for GroundCommand
state TelemetrySender
      TelemetrySender : Downlink requested telemetry packet
state Timer
      Timer : Compute delta_time_beacon
      Timer : Compute delta_time_GPS
      Timer : Compute delta_time_attitude
state MissionMode1
      MissionMode1 : Record impedence probe & multi-spectral sensor data to event log for next 2 minutes at 1 second intervals
state MissionMode2
      MissionMode2 : Turn on current supply to burnwire mechanism for next 1 minute
      MissionMode2 : Record DeCS strain gauge data to event log for next 2 minutes at 1 second intervals
state ProcessDispatcher
      ProcessDispatcher : Check runqueue for scheduled task
state OrbitPropagator
      OrbitPropagator : Compute Spacecraft Attitude
      OrbitPropagator : Compute Orbit position
      OrbitPropagator : Compute Timetable
state GPSreceiver
      GPSreceiver : Ping GPS
state QueryHandler
      QueryHandler : Process query from ground station
state ProcessScheduler
      ProcessScheduler : Add scheduled task to runqueue

[*] --> AntennaDeployment : EPS & CDS \n Powered on \n 45 min delay
AntennaDeployment --> SafeHold
SafeHold -> QueryReceiver
QueryReceiver --> QueryHandler : Ground Interrupt?
QueryReceiver -> Timer : No ground Interrupt
QueryHandler --> TelemetrySender : Telemetry requested
QueryHandler --> ProcessScheduler : Task scheduling requested
TelemetrySender --> QueryReceiver
ProcessScheduler --> QueryReceiver
MissionMode1 --> Timer
MissionMode2 --> Timer
GPSreceiver --> OrbitPropagator
OrbitPropagator --> ProcessDispatcher
Timer --> SafeHold : if delta_time_beacon >= 30 mins
Timer --> GPSreceiver : elseif delta_time_GPS >= 10 mins
Timer --> OrbitPropagator : else
ProcessDispatcher --> SafeHold : scheduled for beacon
ProcessDispatcher --> MissionMode1 : scheduled for MM1
ProcessDispatcher -> MissionMode2 : scheduled for MM1
ProcessDispatcher --> Timer : empty runqueue
@enduml
